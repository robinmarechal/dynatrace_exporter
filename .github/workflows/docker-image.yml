name: Docker Image CI

on:
  push:
    branches: [ "develop", "release/*" ]
  pull_request:
    branches: [ "develop" ]

jobs:

  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Build develop docker image
      if: github.ref == 'refs/heads/develop'
      run: docker build . --file Dockerfile --tag ${{ github.repository }}:develop
      
    - name: Build release docker image
      if: github.ref == refs/heads/release/*
      run: docker build . --file Dockerfile --tag ${{ github.repository }}:$(git rev-parse --abbrev-ref HEAD | cut -d / -f 2)
